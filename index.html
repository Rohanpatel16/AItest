<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Universal AI Demo (No Sign-In)</title>
    
    <!-- 1. Include the Puter.js script -->
    <script src="https://js.puter.com/v2/"></script>

    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #f0f2f5;
            color: #1c1e21;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }
        .container {
            width: 100%;
            max-width: 800px;
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }
        h1 {
            text-align: center;
            margin-top: 0;
            color: #1a73e8;
        }
        .info-box {
            background-color: #e8f0fe;
            border-left: 4px solid #1a73e8;
            padding: 1rem;
            border-radius: 4px;
        }
        form {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        label {
            font-weight: 600;
            margin-bottom: -0.5rem;
        }
        textarea, select {
            width: 100%;
            padding: 0.75rem;
            border-radius: 6px;
            border: 1px solid #ccd0d5;
            font-size: 1rem;
            font-family: inherit;
            box-sizing: border-box;
            resize: vertical;
        }
        textarea {
            min-height: 100px;
        }
        .checkbox-container {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
        }
        button {
            padding: 0.75rem 1.5rem;
            border-radius: 6px;
            border: none;
            background-color: #1a73e8;
            color: white;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }
        button:hover {
            background-color: #1765cf;
        }
        button:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
        }
        button:disabled:after {
            content: '...';
            display: inline-block;
            animation: ellipsis 1.2s infinite;
        }
        #output-container {
            margin-top: 1rem;
            border-top: 1px solid #e0e0e0;
            padding-top: 1.5rem;
        }
        #output {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            padding: 1rem;
            min-height: 150px;
            white-space: pre-wrap;
            word-wrap: break-word;
            line-height: 1.6;
        }
        .error { color: #dc3545; font-weight: bold; }

        @keyframes ellipsis {
            0% { content: '.'; }
            33% { content: '..'; }
            66% { content: '...'; }
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>Universal AI Demo (No Sign-In)</h1>
        <div class="info-box">
            <p>This demo uses Puter.js in <strong>testMode</strong>. Select any model from the comprehensive list below. No login is required.</p>
        </div>

        <form id="ai-form">
            <label for="prompt-input">Your Prompt:</label>
            <textarea id="prompt-input" placeholder="e.g., What is the capital of France?" required>What are the main differences between a llama and an alpaca?</textarea>

            <label for="model-select">Choose a Model:</label>
            <select id="model-select"></select>

            <label class="checkbox-container">
                <input type="checkbox" id="stream-checkbox" checked>
                Stream response in real-time
            </label>

            <button type="submit" id="submit-button">Generate Response</button>
        </form>

        <div id="output-container">
            <h2>AI Response:</h2>
            <div id="output"><p>Your generated response will appear here...</p></div>
        </div>
    </div>

    <script>
        // A comprehensive list of models compiled from all provided documentation.
        const allModels = [
            // Anthropic Models
            'claude-3-5-sonnet',
            'claude-3-7-sonnet',
            'claude-opus-4',
            'claude-sonnet-4',

            // Codestral
            'codestral-latest',

            // DeepSeek Models
            'deepseek-chat',
            'deepseek-reasoner',

            // Google Gemini Models
            'gemini-1.5-flash',
            'gemini-2.0-flash',
            'gemini-pro',
            'gemini-pro-1.5',
            'google/gemini-1.5-flash',
            'google/gemini-2.0-flash-001',
            'google/gemini-2.0-flash-exp:free',
            'google/gemini-2.0-flash-lite-001',
            'google/gemini-2.0-flash-thinking-exp-1219:free',
            'google/gemini-2.0-flash-thinking-exp:free',
            'google/gemini-2.0-pro-exp-02-05:free',
            'google/gemini-2.5-flash-preview',
            'google/gemini-2.5-flash-preview:thinking',
            'google/gemini-2.5-pro-exp-03-25:free',
            'google/gemini-flash-1.5',
            'google/gemini-flash-1.5-8b',
            'google/gemini-flash-1.5-8b-exp',
            'google/gemini-pro-1.5',

            // Grok Models
            'grok-beta',
            'x-ai/grok-3-beta',

            // Meta Llama Models
            'meta-llama/Meta-Llama-3.1-70B-Instruct-Turbo',
            'meta-llama/llama-2-13b-chat',
            'meta-llama/llama-2-70b-chat',
            'meta-llama/llama-3-70b-instruct',
            'meta-llama/llama-3-8b-instruct',
            'meta-llama/llama-3.1-405b',
            'meta-llama/llama-3.1-405b-instruct',
            'meta-llama/llama-3.1-70b-instruct',
            'meta-llama/llama-3.1-8b-instruct',
            'meta-llama/llama-3.2-1b-instruct',
            'meta-llama/llama-3.2-3b-instruct',
            'meta-llama/llama-3.3-70b-instruct',
            'meta-llama/llama-4-maverick',
            'meta-llama/llama-4-scout',
            'meta-llama/llama-guard-2-8b',
            'meta-llama/llama-guard-3-8b',

            // OpenAI Models
            'gpt-4.1',
            'gpt-4.1-mini',
            'gpt-4.1-nano',
            'gpt-4.5-preview',
            'gpt-4o',
            'gpt-4o-mini',
            'o1',
            'o1-mini',
            'o1-pro',
            'o3',
            'o3-mini',
            'o4-mini',

            // OpenRouter Models (a huge list)
            'openrouter:01-ai/yi-large',
            'openrouter:aetherwiing/mn-starcannon-12b',
            'openrouter:agentica-org/deepcoder-14b-preview:free',
            'openrouter:ai21/jamba-1.6-large',
            'openrouter:ai21/jamba-1.6-mini',
            'openrouter:aion-labs/aion-1.0',
            'openrouter:aion-labs/aion-1.0-mini',
            'openrouter:aion-labs/aion-rp-llama-3.1-8b',
            'openrouter:alfredpros/codellama-7b-instruct-solidity',
            'openrouter:all-hands/openhands-lm-32b-v0.1',
            'openrouter:allenai/olmo-7b-instruct',
            'openrouter:alpindale/goliath-120b',
            'openrouter:alpindale/magnum-72b',
            'openrouter:amazon/nova-lite-v1',
            'openrouter:amazon/nova-micro-v1',
            'openrouter:amazon/nova-pro-v1',
            'openrouter:anthracite-org/magnum-v2-72b',
            'openrouter:anthracite-org/magnum-v4-72b',
            'openrouter:anthropic/claude-2',
            'openrouter:anthropic/claude-2.0',
            'openrouter:anthropic/claude-2.0:beta',
            'openrouter:anthropic/claude-2.1',
            'openrouter:anthropic/claude-2.1:beta',
            'openrouter:anthropic/claude-2:beta',
            'openrouter:anthropic/claude-3-haiku',
            'openrouter:anthropic/claude-3-haiku:beta',
            'openrouter:anthropic/claude-3-opus',
            'openrouter:anthropic/claude-3-opus:beta',
            'openrouter:anthropic/claude-3-sonnet',
            'openrouter:anthropic/claude-3-sonnet:beta',
            'openrouter:anthropic/claude-3.5-haiku',
            'openrouter:anthropic/claude-3.5-haiku-20241022',
            'openrouter:anthropic/claude-3.5-haiku-20241022:beta',
            'openrouter:anthropic/claude-3.5-haiku:beta',
            'openrouter:anthropic/claude-3.5-sonnet',
            'openrouter:anthropic/claude-3.5-sonnet-20240620',
            'openrouter:anthropic/claude-3.5-sonnet-20240620:beta',
            'openrouter:anthropic/claude-3.5-sonnet:beta',
            'openrouter:anthropic/claude-3.7-sonnet',
            'openrouter:anthropic/claude-3.7-sonnet:beta',
            'openrouter:anthropic/claude-3.7-sonnet:thinking',
            'openrouter:anthropic/claude-opus-4',
            'openrouter:anthropic/claude-sonnet-4',
            'openrouter:arcee-ai/arcee-blitz',
            'openrouter:arcee-ai/caller-large',
            'openrouter:arcee-ai/coder-large',
            'openrouter:arcee-ai/maestro-reasoning',
            'openrouter:arcee-ai/spotlight',
            'openrouter:arcee-ai/virtuoso-large',
            'openrouter:arcee-ai/virtuoso-medium-v2',
            'openrouter:arliai/qwq-32b-arliai-rpr-v1:free',
            'openrouter:cognitivecomputations/dolphin-mixtral-8x22b',
            'openrouter:cognitivecomputations/dolphin3.0-mistral-24b:free',
            'openrouter:cognitivecomputations/dolphin3.0-r1-mistral-24b:free',
            'openrouter:cohere/command',
            'openrouter:cohere/command-a',
            'openrouter:cohere/command-r',
            'openrouter:cohere/command-r-03-2024',
            'openrouter:cohere/command-r-08-2024',
            'openrouter:cohere/command-r-plus',
            'openrouter:cohere/command-r-plus-04-2024',
            'openrouter:cohere/command-r-plus-08-2024',
            'openrouter:cohere/command-r7b-12-2024',
            'openrouter:deepseek/deepseek-chat',
            'openrouter:deepseek/deepseek-chat-v3-0324',
            'openrouter:deepseek/deepseek-chat-v3-0324:free',
            'openrouter:deepseek/deepseek-chat:free',
            'openrouter:deepseek/deepseek-coder',
            'openrouter:deepseek/deepseek-prover-v2',
            'openrouter:deepseek/deepseek-prover-v2:free',
            'openrouter:deepseek/deepseek-r1',
            'openrouter:deepseek/deepseek-r1-distill-llama-70b',
            'openrouter:deepseek/deepseek-r1-distill-llama-70b:free',
            'openrouter:deepseek/deepseek-r1-distill-llama-8b',
            'openrouter:deepseek/deepseek-r1-distill-qwen-1.5b',
            'openrouter:deepseek/deepseek-r1-distill-qwen-14b',
            'openrouter:deepseek/deepseek-r1-distill-qwen-14b:free',
            'openrouter:deepseek/deepseek-r1-distill-qwen-32b',
            'openrouter:deepseek/deepseek-r1-distill-qwen-32b:free',
            'openrouter:deepseek/deepseek-r1-zero:free',
            'openrouter:deepseek/deepseek-r1:free',
            'openrouter:deepseek/deepseek-v3-base:free',
            'openrouter:eleutherai/llemma_7b',
            'openrouter:eva-unit-01/eva-llama-3.33-70b',
            'openrouter:eva-unit-01/eva-qwen-2.5-32b',
            'openrouter:eva-unit-01/eva-qwen-2.5-72b',
            'openrouter:featherless/qwerky-72b:free',
            'openrouter:google/gemini-2.0-flash-001',
            'openrouter:google/gemini-2.0-flash-exp:free',
            'openrouter:google/gemini-2.0-flash-lite-001',
            'openrouter:google/gemini-2.5-flash-preview',
            'openrouter:google/gemini-2.5-flash-preview-05-20',
            'openrouter:google/gemini-2.5-flash-preview-05-20:thinking',
            'openrouter:google/gemini-2.5-flash-preview:thinking',
            'openrouter:google/gemini-2.5-pro-exp-03-25',
            'openrouter:google/gemini-2.5-pro-preview',
            'openrouter:google/gemini-flash-1.5',
            'openrouter:google/gemini-flash-1.5-8b',
            'openrouter:google/gemini-pro-1.5',
            'openrouter:google/gemma-2-27b-it',
            'openrouter:google/gemma-2-9b-it',
            'openrouter:google/gemma-2-9b-it:free',
            'openrouter:google/gemma-3-12b-it',
            'openrouter:google/gemma-3-12b-it:free',
            'openrouter:google/gemma-3-1b-it:free',
            'openrouter:google/gemma-3-27b-it',
            'openrouter:google/gemma-3-27b-it:free',
            'openrouter:google/gemma-3-4b-it',
            'openrouter:google/gemma-3-4b-it:free',
            'openrouter:google/gemma-3n-e4b-it:free',
            'openrouter:gryphe/mythomax-l2-13b',
            'openrouter:inception/mercury-coder-small-beta',
            'openrouter:infermatic/mn-inferor-12b',
            'openrouter:inflection/inflection-3-pi',
            'openrouter:inflection/inflection-3-productivity',
            'openrouter:liquid/lfm-3b',
            'openrouter:liquid/lfm-40b',
            'openrouter:liquid/lfm-7b',
            'openrouter:mancer/weaver',
            'openrouter:meta-llama/llama-2-70b-chat',
            'openrouter:meta-llama/llama-3-70b-instruct',
            'openrouter:meta-llama/llama-3-8b-instruct',
            'openrouter:meta-llama/llama-3.1-405b',
            'openrouter:meta-llama/llama-3.1-405b-instruct',
            'openrouter:meta-llama/llama-3.1-405b:free',
            'openrouter:meta-llama/llama-3.1-70b-instruct',
            'openrouter:meta-llama/llama-3.1-8b-instruct',
            'openrouter:meta-llama/llama-3.1-8b-instruct:free',
            'openrouter:meta-llama/llama-3.2-11b-vision-instruct',
            'openrouter:meta-llama/llama-3.2-11b-vision-instruct:free',
            'openrouter:meta-llama/llama-3.2-1b-instruct',
            'openrouter:meta-llama/llama-3.2-1b-instruct:free',
            'openrouter:meta-llama/llama-3.2-3b-instruct',
            'openrouter:meta-llama/llama-3.2-3b-instruct:free',
            'openrouter:meta-llama/llama-3.2-90b-vision-instruct',
            'openrouter:meta-llama/llama-3.3-70b-instruct',
            'openrouter:meta-llama/llama-3.3-70b-instruct:free',
            'openrouter:meta-llama/llama-3.3-8b-instruct:free',
            'openrouter:meta-llama/llama-4-maverick',
            'openrouter:meta-llama/llama-4-maverick:free',
            'openrouter:meta-llama/llama-4-scout',
            'openrouter:meta-llama/llama-4-scout:free',
            'openrouter:meta-llama/llama-guard-2-8b',
            'openrouter:meta-llama/llama-guard-3-8b',
            'openrouter:meta-llama/llama-guard-4-12b',
            'openrouter:microsoft/mai-ds-r1:free',
            'openrouter:microsoft/phi-3-medium-128k-instruct',
            'openrouter:microsoft/phi-3-mini-128k-instruct',
            'openrouter:microsoft/phi-3.5-mini-128k-instruct',
            'openrouter:microsoft/phi-4',
            'openrouter:microsoft/phi-4-multimodal-instruct',
            'openrouter:microsoft/phi-4-reasoning',
            'openrouter:microsoft/phi-4-reasoning-plus',
            'openrouter:microsoft/phi-4-reasoning-plus:free',
            'openrouter:microsoft/phi-4-reasoning:free',
            'openrouter:microsoft/wizardlm-2-8x22b',
            'openrouter:minimax/minimax-01',
            'openrouter:mistralai/codestral-2501',
            'openrouter:mistralai/codestral-mamba',
            'openrouter:mistralai/devstral-small',
            'openrouter:mistralai/devstral-small:free',
            'openrouter:mistralai/ministral-3b',
            'openrouter:mistralai/ministral-8b',
            'openrouter:mistralai/mistral-7b-instruct',
            'openrouter:mistralai/mistral-7b-instruct-v0.1',
            'openrouter:mistralai/mistral-7b-instruct-v0.2',
            'openrouter:mistralai/mistral-7b-instruct-v0.3',
            'openrouter:mistralai/mistral-7b-instruct:free',
            'openrouter:mistralai/mistral-large',
            'openrouter:mistralai/mistral-large-2407',
            'openrouter:mistralai/mistral-large-2411',
            'openrouter:mistralai/mistral-medium',
            'openrouter:mistralai/mistral-medium-3',
            'openrouter:mistralai/mistral-nemo',
            'openrouter:mistralai/mistral-nemo:free',
            'openrouter:mistralai/mistral-saba',
            'openrouter:mistralai/mistral-small',
            'openrouter:mistralai/mistral-small-24b-instruct-2501',
            'openrouter:mistralai/mistral-small-24b-instruct-2501:free',
            'openrouter:mistralai/mistral-small-3.1-24b-instruct',
            'openrouter:mistralai/mistral-small-3.1-24b-instruct:free',
            'openrouter:mistralai/mistral-tiny',
            'openrouter:mistralai/mixtral-8x22b-instruct',
            'openrouter:mistralai/mixtral-8x7b-instruct',
            'openrouter:mistralai/pixtral-12b',
            'openrouter:mistralai/pixtral-large-2411',
            'openrouter:moonshotai/kimi-vl-a3b-thinking:free',
            'openrouter:moonshotai/moonlight-16b-a3b-instruct:free',
            'openrouter:neversleep/llama-3-lumimaid-70b',
            'openrouter:neversleep/llama-3-lumimaid-8b',
            'openrouter:neversleep/llama-3-lumimaid-8b:extended',
            'openrouter:neversleep/llama-3.1-lumimaid-70b',
            'openrouter:neversleep/llama-3.1-lumimaid-8b',
            'openrouter:neversleep/noromaid-20b',
            'openrouter:nothingiisreal/mn-celeste-12b',
            'openrouter:nousresearch/deephermes-3-llama-3-8b-preview:free',
            'openrouter:nousresearch/deephermes-3-mistral-24b-preview:free',
            'openrouter:nousresearch/hermes-2-pro-llama-3-8b',
            'openrouter:nousresearch/hermes-3-llama-3.1-405b',
            'openrouter:nousresearch/hermes-3-llama-3.1-70b',
            'openrouter:nousresearch/nous-hermes-2-mixtral-8x7b-dpo',
            'openrouter:nvidia/llama-3.1-nemotron-70b-instruct',
            'openrouter:nvidia/llama-3.1-nemotron-ultra-253b-v1:free',
            'openrouter:nvidia/llama-3.3-nemotron-super-49b-v1',
            'openrouter:nvidia/llama-3.3-nemotron-super-49b-v1:free',
            'openrouter:open-r1/olympiccoder-32b:free',
            'openrouter:openai/chatgpt-4o-latest',
            'openrouter:openai/codex-mini',
            'openrouter:openai/gpt-3.5-turbo',
            'openrouter:openai/gpt-3.5-turbo-0125',
            'openrouter:openai/gpt-3.5-turbo-0613',
            'openrouter:openai/gpt-3.5-turbo-1106',
            'openrouter:openai/gpt-3.5-turbo-16k',
            'openrouter:openai/gpt-3.5-turbo-instruct',
            'openrouter:openai/gpt-4',
            'openrouter:openai/gpt-4-0314',
            'openrouter:openai/gpt-4-1106-preview',
            'openrouter:openai/gpt-4-32k',
            'openrouter:openai/gpt-4-32k-0314',
            'openrouter:openai/gpt-4-turbo',
            'openrouter:openai/gpt-4-turbo-preview',
            'openrouter:openai/gpt-4.1',
            'openrouter:openai/gpt-4.1-mini',
            'openrouter:openai/gpt-4.1-nano',
            'openrouter:openai/gpt-4.5-preview',
            'openrouter:openai/gpt-4o',
            'openrouter:openai/gpt-4o-2024-05-13',
            'openrouter:openai/gpt-4o-2024-08-06',
            'openrouter:openai/gpt-4o-2024-11-20',
            'openrouter:openai/gpt-4o-mini',
            'openrouter:openai/gpt-4o-mini-2024-07-18',
            'openrouter:openai/gpt-4o-mini-search-preview',
            'openrouter:openai/gpt-4o-search-preview',
            'openrouter:openai/gpt-4o:extended',
            'openrouter:openai/o1',
            'openrouter:openai/o1-mini',
            'openrouter:openai/o1-mini-2024-09-12',
            'openrouter:openai/o1-preview',
            'openrouter:openai/o1-preview-2024-09-12',
            'openrouter:openai/o1-pro',
            'openrouter:openai/o3',
            'openrouter:openai/o3-mini',
            'openrouter:openai/o3-mini-high',
            'openrouter:openai/o4-mini',
            'openrouter:openai/o4-mini-high',
            'openrouter:opengvlab/internvl3-14b:free',
            'openrouter:opengvlab/internvl3-2b:free',
            'openrouter:openrouter/auto',
            'openrouter:perplexity/llama-3.1-sonar-large-128k-online',
            'openrouter:perplexity/llama-3.1-sonar-small-128k-online',
            'openrouter:perplexity/r1-1776',
            'openrouter:perplexity/sonar',
            'openrouter:perplexity/sonar-deep-research',
            'openrouter:perplexity/sonar-pro',
            'openrouter:perplexity/sonar-reasoning',
            'openrouter:perplexity/sonar-reasoning-pro',
            'openrouter:pygmalionai/mythalion-13b',
            'openrouter:qwen/qwen-2-72b-instruct',
            'openrouter:qwen/qwen-2.5-72b-instruct',
            'openrouter:qwen/qwen-2.5-72b-instruct:free',
            'openrouter:qwen/qwen-2.5-7b-instruct',
            'openrouter:qwen/qwen-2.5-7b-instruct:free',
            'openrouter:qwen/qwen-2.5-coder-32b-instruct',
            'openrouter:qwen/qwen-2.5-coder-32b-instruct:free',
            'openrouter:qwen/qwen-2.5-vl-7b-instruct',
            'openrouter:qwen/qwen-2.5-vl-7b-instruct:free',
            'openrouter:qwen/qwen-max',
            'openrouter:qwen/qwen-plus',
            'openrouter:qwen/qwen-turbo',
            'openrouter:qwen/qwen-vl-max',
            'openrouter:qwen/qwen-vl-plus',
            'openrouter:qwen/qwen2.5-coder-7b-instruct',
            'openrouter:qwen/qwen2.5-vl-32b-instruct',
            'openrouter:qwen/qwen2.5-vl-32b-instruct:free',
            'openrouter:qwen/qwen2.5-vl-3b-instruct:free',
            'openrouter:qwen/qwen2.5-vl-72b-instruct',
            'openrouter:qwen/qwen2.5-vl-72b-instruct:free',
            'openrouter:qwen/qwen3-14b',
            'openrouter:qwen/qwen3-14b:free',
            'openrouter:qwen/qwen3-235b-a22b',
            'openrouter:qwen/qwen3-235b-a22b:free',
            'openrouter:qwen/qwen3-30b-a3b',
            'openrouter:qwen/qwen3-30b-a3b:free',
            'openrouter:qwen/qwen3-32b',
            'openrouter:qwen/qwen3-32b:free',
            'openrouter:qwen/qwen3-8b',
            'openrouter:qwen/qwen3-8b:free',
            'openrouter:qwen/qwq-32b',
            'openrouter:qwen/qwq-32b-preview',
            'openrouter:qwen/qwq-32b:free',
            'openrouter:raifle/sorcererlm-8x22b',
            'openrouter:rekaai/reka-flash-3:free',
            'openrouter:sao10k/fimbulvetr-11b-v2',
            'openrouter:sao10k/l3-euryale-70b',
            'openrouter:sao10k/l3-lunaris-8b',
            'openrouter:sao10k/l3.1-euryale-70b',
            'openrouter:sao10k/l3.3-euryale-70b',
            'openrouter:scb10x/llama3.1-typhoon2-70b-instruct',
            'openrouter:scb10x/llama3.1-typhoon2-8b-instruct',
            'openrouter:shisa-ai/shisa-v2-llama3.3-70b:free',
            'openrouter:sophosympatheia/midnight-rose-70b',
            'openrouter:thedrummer/anubis-pro-105b-v1',
            'openrouter:thedrummer/rocinante-12b',
            'openrouter:thedrummer/skyfall-36b-v2',
            'openrouter:thedrummer/unslopnemo-12b',
            'openrouter:thedrummer/valkyrie-49b-v1',
            'openrouter:thudm/glm-4-32b',
            'openrouter:thudm/glm-4-32b:free',
            'openrouter:thudm/glm-z1-32b',
            'openrouter:thudm/glm-z1-32b:free',
            'openrouter:thudm/glm-z1-rumination-32b',
            'openrouter:tngtech/deepseek-r1t-chimera:free',
            'openrouter:undi95/remm-slerp-l2-13b',
            'openrouter:undi95/toppy-m-7b',
            'openrouter:x-ai/grok-2-1212',
            'openrouter:x-ai/grok-2-vision-1212',
            'openrouter:x-ai/grok-3-beta',
            'openrouter:x-ai/grok-3-mini-beta',
            'openrouter:x-ai/grok-beta',
            'openrouter:x-ai/grok-vision-beta',
        ];

        // Deduplicate and sort the model list for the dropdown
        const uniqueModels = [...new Set(allModels)].sort();

        const form = document.getElementById('ai-form');
        const promptInput = document.getElementById('prompt-input');
        const modelSelect = document.getElementById('model-select');
        const streamCheckbox = document.getElementById('stream-checkbox');
        const submitButton = document.getElementById('submit-button');
        const outputDiv = document.getElementById('output');

        function populateModelDropdown() {
            uniqueModels.forEach(modelName => {
                const option = document.createElement('option');
                option.value = modelName;
                option.textContent = modelName;
                modelSelect.appendChild(option);
            });
            // Set a reliable default model
            modelSelect.value = 'claude-3-5-sonnet';
        }
        
        form.addEventListener('submit', async (event) => {
            event.preventDefault(); 

            submitButton.disabled = true;
            submitButton.textContent = 'Thinking';
            outputDiv.innerHTML = '';

            const prompt = promptInput.value;
            const model = modelSelect.value;
            const useStream = streamCheckbox.checked;

            try {
                // The options object is where we define the model, streaming, and testMode.
                const options = {
                    model: model,
                    stream: useStream,
                    testMode: true 
                };
                
                if (useStream) {
                    const responseStream = await puter.ai.chat(prompt, options);
                    for await (const part of responseStream) {
                        // The structure of streaming responses can vary slightly.
                        // We check for `part.text` first, which is common.
                        // Then we check `part.message.content` for non-streaming formats that might appear.
                        let chunk = part?.text;
                        if(chunk === undefined && part?.message?.content){
                           chunk = part.message.content;
                        }

                        if (chunk) {
                            // In some cases, chunks might not be strings. Ensure it's a string before replacing.
                            outputDiv.innerHTML += String(chunk).replaceAll('\n', '<br>');
                        }
                    }
                } else {
                    const response = await puter.ai.chat(prompt, options);
                     // Non-streaming responses can have different structures. We check the most common ones.
                    let content = response?.message?.content;
                    if(content === undefined){
                        content = response; // Some models might return the string directly.
                    }
                     // The content itself could be an array (like in some Claude models)
                    if(Array.isArray(content) && content[0]?.text){
                        content = content[0].text;
                    }
                    if (content) {
                        outputDiv.textContent = content;
                    } else {
                        outputDiv.innerHTML = `<p class="error">Received an unexpected response. Check the console.</p>`;
                        console.log("Unexpected response format:", response);
                    }
                }

            } catch (error) {
                console.error("Puter.js AI Error:", error);
                outputDiv.innerHTML = `<p class="error">An error occurred: ${error.message}.</p>`;
            } finally {
                submitButton.disabled = false;
                submitButton.textContent = 'Generate Response';
            }
        });

        populateModelDropdown();

    </script>

</body>
</html>
